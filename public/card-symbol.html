<!DOCTYPE html>
<html lang="pt">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>An√°lises de Empresas e Cota√ß√µes</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <style>
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px)
      }

      to {
        opacity: 1;
        transform: translateY(0)
      }
    }

    @keyframes pulse {

      0%,
      100% {
        opacity: 1
      }

      50% {
        opacity: .5
      }
    }

    @keyframes spin {
      to {
        transform: rotate(360deg)
      }
    }

    .fade-in {
      animation: fadeIn .3s ease-out
    }

    .pulse {
      animation: pulse 2s cubic-bezier(.4, 0, .6, 1) infinite
    }

    .spin {
      animation: spin 1s linear infinite
    }

    .glass {
      backdrop-filter: blur(10px);
      background: rgba(255, 255, 255, .1);
      border: 1px solid rgba(255, 255, 255, .2)
    }

    .dark .glass {
      background: rgba(0, 0, 0, .2);
      border: 1px solid rgba(255, 255, 255, .1)
    }

    .checkbox-custom {
      appearance: none;
      width: 18px;
      height: 18px;
      border: 2px solid #d1d5db;
      border-radius: 4px;
      background: #fff;
      position: relative;
      cursor: pointer;
      transition: all .2s
    }

    .checkbox-custom:checked {
      background: #3b82f6;
      border-color: #3b82f6
    }

    .checkbox-custom:checked::after {
      content: '‚úì';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: #fff;
      font-size: 12px;
      font-weight: bold
    }

    .dark .checkbox-custom {
      background: #374151;
      border-color: #4b5563
    }

    .toast {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      transform: translateX(400px);
      transition: transform .3s ease-out
    }

    .toast.show {
      transform: translateX(0)
    }
  </style>
  <!-- Primary meta -->
  <meta id="metaDescription" name="description"
    content="Visualize indicadores t√©cnicos e informa√ß√µes de empresas em tempo real" />
  <link id="canonicalLink" rel="canonical" href="" />
  <!-- Alternate hreflang links will be injected by JS for SEO multilanguage -->

  <!-- Open Graph -->
  <meta property="og:type" content="website" />
  <meta id="ogTitle" property="og:title" content="An√°lises de A√ß√µes" />
  <meta id="ogDescription" property="og:description"
    content="Visualize indicadores t√©cnicos e informa√ß√µes de empresas em tempo real" />
  <meta id="ogLocale" property="og:locale" content="pt_PT" />
  <meta property="og:site_name" content="NovaStocks" />
  <!-- Twitter -->
  <meta id="twTitle" name="twitter:title" content="An√°lises de A√ß√µes" />
  <meta id="twDescription" name="twitter:description"
    content="Visualize indicadores t√©cnicos e informa√ß√µes de empresas em tempo real" />

</head>

<body
  class="bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800 text-gray-900 dark:text-white min-h-screen transition-all duration-300">
  <div id="header-widget"></div>
  <!-- 2) Include the widget script -->
  <script type="module" src="header.js"></script>
  <div class="max-w-6xl mx-auto p-4 sm:p-6 lg:p-8">

    <!-- Header -->
    <div class="glass rounded-2xl p-6 mb-8 shadow-lg">
      <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 w-full">
        <div>
          <h1 id="title"
            class="text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent"></h1>
          <p id="subtitle" class="text-gray-600 dark:text-gray-300 mt-1"></p>
        </div>
        <div class="flex items-center gap-2">
          <!-- language selector -->
          <select id="langSelect" class="glass px-3 py-2 rounded-xl cursor-pointer text-sm focus:outline-none">
            <option value="pt">üáµüáπ PT</option>
            <option value="en">üá¨üáß EN</option>
          </select>
          <button id="toggleTheme"
            class="glass px-6 py-3 rounded-xl hover:bg-opacity-20 transition-all duration-200 group"><span
              class="mr-2">üåó</span><span id="themeLabel"
              class="group-hover:text-blue-400 transition-colors"></span></button>
        </div>
      </div>
    </div>

    <!-- Input Section -->
    <div class="glass rounded-2xl p-6 mb-8 shadow-lg">
      <h2 id="searchHeader" class="text-xl font-semibold mb-4 flex items-center"><span class="mr-2">üîç</span></h2>
      <div class="flex flex-col sm:flex-row gap-3 mb-6 relative">
        <div class="flex-1 relative">
          <input list="symbolSuggestions" id="symbolInput" maxlength="10"
            class="w-full p-4 rounded-xl border-2 border-gray-200 dark:border-gray-600 dark:bg-gray-800 focus:border-blue-500 dark:focus:border-blue-400 transition-all duration-200 outline-none text-lg" />
          <datalist id="symbolSuggestions"></datalist>
          <div id="symbolValidation"
            class="absolute right-3 top-1/2 transform -translate-y-1/2 text-green-500 opacity-0 transition-opacity">‚úì
          </div>
        </div>
        <div class="flex gap-3">
          <button id="plotBtn" disabled
            class="bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white px-6 py-4 rounded-xl transition-all duration-200 font-semibold shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none"><span
              id="plotBtnText"></span><span id="plotBtnSpinner" class="hidden"><svg class="spin w-5 h-5 inline ml-2"
                fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor"
                  d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                </path>
              </svg></span></button>
          <button id="clearBtn"
            class="bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white px-6 py-4 rounded-xl transition-all duration-200 font-semibold shadow-lg hover:shadow-xl transform hover:-translate-y-0.5"></button>
        </div>
      </div>
      <!-- Analysis Type Selection -->
      <div class="space-y-4">
        <h3 id="analysisHeader" class="text-lg font-semibold flex items-center"><span class="mr-2">‚öôÔ∏è</span></h3>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
          <!-- Checkbox cards -->
          <label
            class="flex items-center space-x-3 p-4 rounded-xl border-2 border-gray-200 dark:border-gray-600 hover:border-blue-400 dark:hover:border-blue-500 transition-all duration-200 cursor-pointer group"><input
              type="checkbox" value="perfil" class="typeChk checkbox-custom" />
            <div class="flex-1">
              <div id="labelPerfil"
                class="font-medium group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors"></div>
              <div id="hintPerfil" class="text-sm text-gray-500 dark:text-gray-400"></div>
            </div>
          </label>
          <label
            class="flex items-center space-x-3 p-4 rounded-xl border-2 border-gray-200 dark:border-gray-600 hover:border-blue-400 dark:hover:border-blue-500 transition-all duration-200 cursor-pointer group"><input
              type="checkbox" value="rsi" class="typeChk checkbox-custom" />
            <div class="flex-1">
              <div id="labelRSI"
                class="font-medium group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors"></div>
              <div id="hintRSI" class="text-sm text-gray-500 dark:text-gray-400"></div>
            </div>
          </label>
          <label
            class="flex items-center space-x-3 p-4 rounded-xl border-2 border-gray-200 dark:border-gray-600 hover:border-blue-400 dark:hover:border-blue-500 transition-all duration-200 cursor-pointer group"><input
              type="checkbox" value="macd" class="typeChk checkbox-custom" />
            <div class="flex-1">
              <div id="labelMACD"
                class="font-medium group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors"></div>
              <div id="hintMACD" class="text-sm text-gray-500 dark:text-gray-400"></div>
            </div>
          </label>
          <label
            class="flex items-center space-x-3 p-4 rounded-xl border-2 border-gray-200 dark:border-gray-600 hover:border-blue-400 dark:hover:border-blue-500 transition-all duration-200 cursor-pointer group"><input
              type="checkbox" value="sma" class="typeChk checkbox-custom" />
            <div class="flex-1">
              <div id="labelSMA"
                class="font-medium group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors"></div>
              <div id="hintSMA" class="text-sm text-gray-500 dark:text-gray-400"></div>
            </div>
          </label>
        </div>
      </div>
    </div>

    <!-- Progress Bar -->
    <div id="progressContainer" class="hidden mb-8">
      <div class="glass rounded-xl p-4 shadow-lg">
        <div class="flex items-center justify-between mb-2"><span id="progressLabel"
            class="text-sm font-medium"></span><span id="progressText"
            class="text-sm text-gray-600 dark:text-gray-400">0%</span></div>
        <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
          <div id="progressBar"
            class="bg-gradient-to-r from-blue-600 to-purple-600 h-2 rounded-full transition-all duration-300"
            style="width:0%"></div>
        </div>
      </div>
    </div>

    <!-- Results Section -->
    <div id="result" class="space-y-6"></div>
    <!-- Chart Section -->
    <div id="chartContainer" class="hidden">
      <div class="glass rounded-2xl p-6 shadow-lg">
        <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6">
          <h2 id="chartHeader" class="text-2xl font-semibold flex items-center"><span class="mr-2">üìà</span></h2>
          <div class="flex gap-3"><button id="exportPng"
              class="bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white px-4 py-2 rounded-lg transition-all duration-200 font-medium shadow-md hover:shadow-lg transform hover:-translate-y-0.5">üì∑
              PNG</button><button id="exportCsv"
              class="bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 text-white px-4 py-2 rounded-lg transition-all duration-200 font-medium shadow-md hover:shadow-lg transform hover:-translate-y-0.5">üìä
              CSV</button></div>
        </div>
        <div id="chart" class="rounded-xl shadow-inner bg-white dark:bg-gray-800 min-h-96"></div>
      </div>
    </div>

    <!-- Empty State -->
    <div id="emptyState" class="text-center py-16">
      <div class="text-6xl mb-4">üìä</div>
      <h3 id="emptyTitle" class="text-xl font-semibold text-gray-600 dark:text-gray-300 mb-2"></h3>
      <p id="emptyText" class="text-gray-500 dark:text-gray-400 max-w-md mx-auto"></p>
    </div>
  </div>

  <!-- Toast Container -->
  <div id="toastContainer"></div>

 <script>
/**************** I18N strings ****************/
   const STRINGS = {
      pt: {
        title: 'An√°lises de A√ß√µes',
        subtitle: 'Visualize indicadores t√©cnicos e informa√ß√µes de empresas',
        theme: 'Tema',
        searchHeader: 'Buscar A√ß√£o',
        placeholder: 'Ex: PLTR, AAPL, MSFT...',
        analyse: 'üìä Analisar',
        clear: 'üßπ Limpar',
        analysisHeader: 'Tipos de An√°lise',
        labelPerfil: 'Perfil',
        hintPerfil: 'Informa√ß√µes da empresa',
        labelRSI: 'RSI',
        hintRSI: 'For√ßa relativa',
        labelMACD: 'MACD',
        hintMACD: 'Converg√™ncia/Diverg√™ncia',
        labelSMA: 'SMA',
        hintSMA: 'M√©dia m√≥vel simples',
        progress: 'Analisando...',
        chartHeader: 'Gr√°fico de An√°lise',
        emptyTitle: 'Pronto para come√ßar?',
        emptyText: 'Digite o s√≠mbolo de uma a√ß√£o, selecione os tipos de an√°lise e clique em "Analisar" para visualizar os dados.',
        invalidSymbol: 'S√≠mbolo inv√°lido',
        selectType: 'Selecione pelo menos um tipo',
        noData: 'Nenhum dado encontrado',
        done: 'An√°lise conclu√≠da para',
        cleaned: 'Dados limpos'
      },
      en: {
        title: 'Stock Analysis',
        subtitle: 'Visualize technical indicators and company information',
        theme: 'Theme',
        searchHeader: 'Search Stock',
        placeholder: 'Eg: PLTR, AAPL, MSFT...',
        analyse: 'üìä Analyse',
        clear: 'üßπ Clear',
        analysisHeader: 'Analysis Types',
        labelPerfil: 'Profile',
        hintPerfil: 'Company information',
        labelRSI: 'RSI',
        hintRSI: 'Relative strength',
        labelMACD: 'MACD',
        hintMACD: 'Convergence/Divergence',
        labelSMA: 'SMA',
        hintSMA: 'Simple moving average',
        progress: 'Analysing...',
        chartHeader: 'Analysis Chart',
        emptyTitle: 'Ready to start?',
        emptyText: 'Enter a stock symbol, choose analysis types and click "Analyse" to see data.',
        invalidSymbol: 'Invalid symbol',
        selectType: 'Select at least one type',
        noData: 'No data found',
        done: 'Analysis finished for',
        cleaned: 'Data cleared'
      }
    };

/********************** UTILS **********************/
function $(sel) { return document.querySelector(sel); }
const debounce = (fn, d = 300) => { let t; return (...a) => { clearTimeout(t); t = setTimeout(() => fn(...a), d); }; };
const validateSymbol = s => !!s && s.length <= 10 && /^[A-Z0-9]+$/.test(s);

/********************** SEO **********************/
function updateSeoLinks() {
  const base = `${location.origin}${location.pathname}`;
  const canonical = LANG === 'pt' ? base : `${base}?lang=${LANG}`;
  $('#canonicalLink')?.setAttribute('href', canonical);

  /* rebuild alternates */
  document.querySelectorAll('link[rel="alternate"]').forEach(l => l.remove());

  Object.keys(STRINGS).forEach(l => {
    const link = document.createElement('link');
    link.rel = 'alternate';
    link.hreflang = l;
    link.href = l === 'pt' ? base : `${base}?lang=${l}`;
    document.head.appendChild(link);
  });

  const xDef = document.createElement('link');
  xDef.rel = 'alternate';
  xDef.hreflang = 'x-default';
  xDef.href = base;
  document.head.appendChild(xDef);
}

/********************** I18N **********************/
let LANG = localStorage.getItem('lang') || 'pt';
function translate() {
  const S = STRINGS[LANG];
  $('#title').textContent        = S.title;
  $('#subtitle').textContent     = S.subtitle;
  $('#themeLabel').textContent   = S.theme;
  $('#searchHeader').innerHTML   = `<span class="mr-2">üîç</span>${S.searchHeader}`;
  $('#symbolInput').placeholder  = S.placeholder;
  $('#plotBtnText').textContent  = S.analyse;
  $('#clearBtn').textContent     = S.clear;
  $('#analysisHeader').innerHTML = `<span class="mr-2">‚öôÔ∏è</span>${S.analysisHeader}`;
  $('#labelPerfil').textContent  = S.labelPerfil;
  $('#hintPerfil').textContent   = S.hintPerfil;
  $('#labelRSI').textContent     = S.labelRSI;
  $('#hintRSI').textContent      = S.hintRSI;
  $('#labelMACD').textContent    = S.labelMACD;
  $('#hintMACD').textContent     = S.hintMACD;
  $('#labelSMA').textContent     = S.labelSMA;
  $('#hintSMA').textContent      = S.hintSMA;
  $('#progressLabel').textContent= S.progress;
  $('#chartHeader').innerHTML    = `<span class="mr-2">üìà</span>${S.chartHeader}`;
  $('#emptyTitle').textContent   = S.emptyTitle;
  $('#emptyText').textContent    = S.emptyText;
}

/********************** INIT **********************/
document.addEventListener('DOMContentLoaded', () => {
  /* -------- DOM refs (only after DOM ready) -------- */
  const langSelect       = $('#langSelect');
  const input            = $('#symbolInput');
  const datalist         = $('#symbolSuggestions');
  const plotBtn          = $('#plotBtn');
  const plotBtnText      = $('#plotBtnText');
  const plotBtnSpinner   = $('#plotBtnSpinner');
  const clearBtn         = $('#clearBtn');
  const resultDiv        = $('#result');
  const chartDiv         = $('#chart');
  const chartContainer   = $('#chartContainer');
  const progressContainer= $('#progressContainer');
  const progressBar      = $('#progressBar');
  const progressText     = $('#progressText');
  const emptyState       = $('#emptyState');
  const symbolValidation = $('#symbolValidation');
  const toastContainer   = $('#toastContainer');

  /* -------- I18N & SEO on first load -------- */
  translate();
  updateSeoLinks();
  langSelect.value = LANG;

  /* -------- Theme -------- */
  const prefersDark = localStorage.getItem('theme') === 'dark' ||
                      (!localStorage.getItem('theme') && matchMedia('(prefers-color-scheme:dark)').matches);
  if (prefersDark) document.body.classList.add('dark');

  $('#toggleTheme')?.addEventListener('click', () => {
    document.body.classList.toggle('dark');
    localStorage.setItem('theme', document.body.classList.contains('dark') ? 'dark' : 'light');
    if (seriesData.length)
      Plotly.relayout(chartDiv, { 'font.color': document.body.classList.contains('dark') ? '#fff' : '#000' });
  });

  /* -------- Lang switch -------- */
  langSelect.addEventListener('change', e => {
    LANG = e.target.value;
    localStorage.setItem('lang', LANG);
    translate();
    updateSeoLinks();
  });

  /* -------- Toast helper -------- */
  function showToast(msg, type='info', ms=3000) {
    const t = document.createElement('div');
    t.className = `toast glass p-4 rounded-xl shadow-lg max-w-sm ${
      type==='error'  ? 'border-l-4 border-red-500'  :
      type==='success'? 'border-l-4 border-green-500': 'border-l-4 border-blue-500'}`;
    t.innerHTML = `<div class="flex items-center"><span class="mr-2">${
      type==='error' ? '‚ùå' : type==='success' ? '‚úÖ' : '‚ÑπÔ∏è'
    }</span><span>${msg}</span></div>`;
    toastContainer.appendChild(t);
    requestAnimationFrame(() => t.classList.add('show'));
    setTimeout(() => { t.classList.remove('show'); setTimeout(() => t.remove(), 300); }, ms);
  }

  /* -------- Autocomplete -------- */
  const fetchSuggestions = debounce(async q => {
    if (q.length < 2) return datalist.innerHTML = '';
    try {
      const res = await fetch(`/api/analises?query=${encodeURIComponent(q)}`);
      if (!res.ok) throw new Error('HTTP '+res.status);
      const sugg = await res.json();
      datalist.innerHTML = sugg.slice(0,10).map(s =>
        `<option value="${s.symbol}">${s.name} (${s.exchange})</option>`).join('');
    } catch { datalist.innerHTML = ''; }
  });

  /* -------- Inputs & validation -------- */
  let seriesData = [], isLoading = false;

  function setLoadingState(on) {
    isLoading = on;
    plotBtn.disabled = on;
    plotBtnText.classList.toggle('hidden', on);
    plotBtnSpinner.classList.toggle('hidden', !on);
    progressContainer.classList.toggle('hidden', !on);
    if (!on) updateProgress(0,1);
  }

  function updateProgress(cur, tot) {
    const pct = Math.round(cur / tot * 100);
    progressBar.style.width = pct + '%';
    progressText.textContent = pct + '%';
  }

  input.addEventListener('input', e => {
    const v = e.target.value.toUpperCase().trim();
    e.target.value = v;
    const valid = validateSymbol(v);
    plotBtn.disabled = !valid || isLoading || !document.querySelectorAll('.typeChk:checked').length;
    symbolValidation.style.opacity = v && valid ? '1' : '0';
    fetchSuggestions(v);
  });

  input.addEventListener('keypress', e => {
    if (e.key === 'Enter' && !plotBtn.disabled) plotBtn.click();
  });

  document.querySelectorAll('.typeChk').forEach(cb =>
    cb.addEventListener('change', () => {
      const any = !!document.querySelectorAll('.typeChk:checked').length;
      plotBtn.disabled = !any || !validateSymbol(input.value.trim()) || isLoading;
    })
  );

  /* -------- Analyse -------- */
  plotBtn.addEventListener('click', async () => {
    const S = STRINGS[LANG];
    const symbol = input.value.trim().toUpperCase();
    if (!validateSymbol(symbol)) return showToast(S.invalidSymbol,'error');

    const types = [...document.querySelectorAll('.typeChk:checked')].map(el => el.value);
    if (!types.length) return showToast(S.selectType,'error');

    setLoadingState(true);
    resultDiv.innerHTML = ''; chartDiv.innerHTML = ''; seriesData = [];
    let done = 0, total = types.length;

    for (const tipo of types) {
      try {
        const res = await fetch(`/api/analises?symbol=${symbol}&tipo=${tipo}`);
        if (!res.ok) throw new Error('HTTP '+res.status);
        const data = await res.json();

        if (tipo === 'perfil') {
          const s = data.summary || {};
          const card = document.createElement('div');
          card.className = 'glass rounded-2xl p-6 shadow-lg fade-in';
          card.innerHTML = card.innerHTML = `
  <div class="flex flex-col sm:flex-row items-start sm:items-center space-y-4 sm:space-y-0 sm:space-x-6 mb-6">
    ${
      data.logo
        ? `<img src="${data.logo}" class="w-16 h-16 rounded-xl shadow-md"/>`
        : `<div class="w-16 h-16 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold text-xl">${symbol.charAt(0)}</div>`
    }
    <div class="flex-1">
      <h2 class="text-2xl font-bold mb-1">
        ${data.name || symbol}
        <span class="text-lg text-gray-500 dark:text-gray-400 font-normal ml-2">
          (${data.symbol || symbol})
        </span>
      </h2>
      ${
        s.sector && s.industry
          ? `<p class="text-gray-600 dark:text-gray-300 font-medium">${s.sector} ‚Ä¢ ${s.industry}</p>`
          : ''
      }
    </div>
  </div>
  ${
    s.businessSummary
      ? `<div class="bg-gray-50 dark:bg-gray-700 rounded-xl p-4 mb-4">
           <p class="text-gray-700 dark:text-gray-300 leading-relaxed">${s.businessSummary}</p>
         </div>`
      : ''
  }
`;
          resultDiv.appendChild(card);
        } else if (data.chart?.x && data.chart?.y) {
          seriesData.push({
            x: data.chart.x,
            y: data.chart.y,
            mode: 'lines',
            name: tipo.toUpperCase(),
            line: { width: 2, color:
              tipo==='rsi' ? '#ef4444' :
              tipo==='macd'? '#10b981' :
              tipo==='sma' ? '#8b5cf6' : '#3b82f6'
            }
          });
        }
      } catch { showToast(`Erro ${tipo.toUpperCase()}`, 'error'); }
      updateProgress(++done, total);
    }

    if (seriesData.length) {
      chartContainer.classList.remove('hidden');
      const dark = document.body.classList.contains('dark');
      await Plotly.newPlot(chartDiv, seriesData, {
        title: { text: `${S.chartHeader} - ${symbol}`, font: { size:20, color: dark ? '#fff':'#000' } },
        paper_bgcolor:'transparent', plot_bgcolor:'transparent',
        font:{ color: dark ? '#fff':'#000' },
        margin:{ l:60, r:40, t:60, b:60 },
        hovermode:'x unified'
      }, { responsive:true, displayModeBar:true, displaylogo:false });
    }

    setLoadingState(false);
    showToast(seriesData.length || resultDiv.innerHTML ? `${S.done} ${symbol}` : S.noData,
              seriesData.length || resultDiv.innerHTML ? 'success' : 'error');
  });

  /* -------- Clear -------- */
  clearBtn.addEventListener('click', () => {
    const S = STRINGS[LANG];
    input.value=''; datalist.innerHTML='';
    resultDiv.innerHTML=''; chartDiv.innerHTML='';
    chartContainer.classList.add('hidden');
    seriesData=[]; symbolValidation.style.opacity='0';
    plotBtn.disabled=true;
    document.querySelectorAll('.typeChk').forEach(cb=>cb.checked=false);
    emptyState.classList.remove('hidden');
    showToast(S.cleaned,'success');
  });

  emptyState.classList.remove('hidden');
});
</script>
 
  <footer class="bg-black text-center py-12 text-gray-600">
    <div class="space-y-4">
      <p class="text-sm">¬© 2025 NovaStocks.</p>
      <p class="text-xs text-gray-500">Os dados s√£o fornecidos "como est√£o" e destinam-se apenas a fins informativos, n√£o para fins comerciais.</p>
    </div>
  </footer>
</body>

</html>