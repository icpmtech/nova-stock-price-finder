<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Carteira de Investimentos</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Chart.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>

  <style>
    body {
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
      min-height: 100vh;
    }
    .card-hover { transition: all 0.3s ease; }
    .card-hover:hover { transform: translateY(-4px); }
    .pulse { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: .5; }
    }
  </style>
</head>

<body class="text-white font-sans">
  <div class="container mx-auto px-4 py-6 max-w-7xl">
    <!-- Header -->
    <header class="mb-8">
      <div class="flex items-center justify-between">
        <div>
          <h1 class="text-4xl font-bold bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent">
            üíº Nova Wallet
          </h1>
          <p class="text-gray-400 mt-2">Dashboard com comiss√µes e lucro em tempo real</p>
        </div>
        <div class="text-right">
          <div class="text-sm text-gray-400">√öltima atualiza√ß√£o</div>
          <div id="lastUpdate" class="text-green-400 font-semibold"></div>
        </div>
      </div>
    </header>

    <!-- M√©tricas principais -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
      <!-- Saldo -->
      <div class="bg-gray-800/50 backdrop-blur-sm p-6 rounded-xl shadow-lg card-hover border border-gray-700">
        <div class="flex items-center justify-between mb-2">
          <h3 class="text-sm font-medium text-gray-400">Saldo Total</h3>
          <span class="text-2xl">üí∞</span>
        </div>
        <div id="saldoTotal" class="text-3xl font-bold text-green-400">‚Ç¨ 0</div>
        <p class="text-xs text-gray-500 mt-1">* Deduzido comiss√µes</p>
      </div>

      <!-- Lucro -->
      <div class="bg-gray-800/50 backdrop-blur-sm p-6 rounded-xl shadow-lg card-hover border border-gray-700">
        <div class="flex items-center justify-between mb-2">
          <h3 class="text-sm font-medium text-gray-400">Lucro/Preju√≠zo</h3>
          <span class="text-2xl">üìà</span>
        </div>
        <div id="lucroTotal" class="text-3xl font-bold">‚Ç¨ 0</div>
        <div id="lucroPercentual" class="text-sm mt-1">0.00%</div>
      </div>

      <!-- Investido -->
      <div class="bg-gray-800/50 backdrop-blur-sm p-6 rounded-xl shadow-lg card-hover border border-gray-700">
        <div class="flex items-center justify-between mb-2">
          <h3 class="text-sm font-medium text-gray-400">Total Investido</h3>
          <span class="text-2xl">üí∏</span>
        </div>
        <div id="totalInvestido" class="text-3xl font-bold text-blue-400">‚Ç¨ 0</div>
        <div id="totalAcoes" class="text-xs text-gray-500 mt-1">0 a√ß√µes</div>
      </div>

      <!-- Comiss√µes -->
      <div class="bg-gray-800/50 backdrop-blur-sm p-6 rounded-xl shadow-lg card-hover border border-gray-700">
        <div class="flex items-center justify-between mb-2">
          <h3 class="text-sm font-medium text-gray-400">Comiss√µes</h3>
          <span class="text-2xl">üè¶</span>
        </div>
        <div id="totalComissoes" class="text-3xl font-bold text-red-400">‚Ç¨ 0</div>
        <div id="comissaoPercentual" class="text-xs text-gray-500 mt-1">0.00% do total</div>
      </div>
    </div>

    <!-- Gr√°ficos -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
      <!-- Pizza -->
      <div class="bg-gray-800/50 backdrop-blur-sm p-6 rounded-xl shadow-lg border border-gray-700">
        <h3 class="text-lg font-semibold mb-4 text-gray-200">Distribui√ß√£o da Carteira</h3>
        <div class="h-64"><canvas id="pieChart"></canvas></div>
      </div>

      <!-- Barras -->
      <div class="bg-gray-800/50 backdrop-blur-sm p-6 rounded-xl shadow-lg border border-gray-700">
        <h3 class="text-lg font-semibold mb-4 text-gray-200">Performance por Ativo</h3>
        <div class="h-64"><canvas id="barChart"></canvas></div>
      </div>
    </div>

    <!-- Carteira -->
    <section class="mb-8">
      <div class="flex items-center justify-between mb-4">
        <h2 class="text-2xl font-semibold text-gray-200">Carteira de Investimentos</h2>
        <button id="refreshBtn" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-lg text-sm font-medium transition-colors">
          üîÑ Atualizar Pre√ßos
        </button>
      </div>
      <div id="carteiraContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
    </section>

    <!-- Transa√ß√µes -->
    <section>
      <div class="flex items-center justify-between mb-4">
        <h2 class="text-2xl font-semibold text-gray-200">Transa√ß√µes Recentes</h2>
        <div class="flex gap-2">
          <select id="filterTipo" class="bg-gray-700 text-white px-3 py-1 rounded text-sm">
            <option value="">Todos os tipos</option>
            <option value="Compra">Compra</option>
            <option value="Venda">Venda</option>
          </select>
          <input id="searchSymbol" type="text" placeholder="Buscar s√≠mbolo..."
                 class="bg-gray-700 text-white px-3 py-1 rounded text-sm w-32">
        </div>
      </div>

      <div class="bg-gray-800/50 backdrop-blur-sm rounded-xl overflow-hidden shadow-lg border border-gray-700">
        <div class="overflow-x-auto">
          <table class="w-full text-sm text-left">
            <thead class="bg-gray-700/50 text-gray-300">
              <tr>
                <th class="px-6 py-3 font-semibold">Tipo</th>
                <th class="px-6 py-3 font-semibold">S√≠mbolo</th>
                <th class="px-6 py-3 font-semibold">Quantidade</th>
                <th class="px-6 py-3 font-semibold">Pre√ßo</th>
                <th class="px-6 py-3 font-semibold">Comiss√£o</th>
                <th class="px-6 py-3 font-semibold">Total</th>
                <th class="px-6 py-3 font-semibold">Data</th>
              </tr>
            </thead>
            <tbody id="transacoesTable"></tbody>
          </table>
        </div>
      </div>
    </section>
  </div>

  <!-- Script principal -->
  <script>
    /* -------------------- Dados de exemplo -------------------- */
    const carteira = [
      { nome: 'AAPL', acoes: 10, precoCompra: 170, precoAtual: 195, setor: 'Tecnologia' },
      { nome: 'MSFT', acoes: 5,  precoCompra: 340, precoAtual: 355, setor: 'Tecnologia' },
      { nome: 'GOOG', acoes: 2,  precoCompra: 1200, precoAtual: 1300, setor: 'Tecnologia' },
      { nome: 'TSLA', acoes: 3,  precoCompra: 800,  precoAtual: 750,  setor: 'Autom√≥vel' },
      { nome: 'NVDA', acoes: 4,  precoCompra: 400,  precoAtual: 450,  setor: 'Tecnologia' },
    ];

    const transacoes = [
      { tipo: 'Compra', simbolo: 'AAPL', quantidade: 5, preco: 190, comissao: 2.5,  data: '2025-07-06' },
      { tipo: 'Venda',  simbolo: 'TSLA', quantidade: 2, preco: 250, comissao: 1.75, data: '2025-07-05' },
      { tipo: 'Compra', simbolo: 'GOOG', quantidade: 1, preco: 1300,comissao: 3.2,  data: '2025-07-04' },
      { tipo: 'Compra', simbolo: 'MSFT', quantidade: 2, preco: 355, comissao: 1.8,  data: '2025-07-03' },
      { tipo: 'Compra', simbolo: 'NVDA', quantidade: 4, preco: 450, comissao: 4.5,  data: '2025-07-02' },
      { tipo: 'Venda',  simbolo: 'AAPL', quantidade: 3, preco: 195, comissao: 1.2,  data: '2025-07-01' },
    ];

    /* -------------------- Vari√°veis de estado -------------------- */
    let filteredTransacoes = [...transacoes];
    let pieChart, barChart;

    /* -------------------- C√°lculo de m√©tricas -------------------- */
    function calcularMetricas() {
      const totalComissoes    = transacoes.reduce((s, tx)  => s + tx.comissao, 0);
      const totalInvestido    = carteira.reduce((t, at)  => t + at.precoCompra * at.acoes, 0);
      const valorAtual        = carteira.reduce((t, at)  => t + at.precoAtual  * at.acoes, 0);
      const totalAcoes        = carteira.reduce((s, at)  => s + at.acoes, 0);
      const lucroTotal        = valorAtual - totalInvestido;
      const lucroPercentual   = (lucroTotal / totalInvestido) * 100;
      const comissaoPercent   = (totalComissoes / totalInvestido) * 100;
      const saldoTotal        = valorAtual - totalComissoes;

      /* ---- Actualiza UI ---- */
      document.getElementById('totalComissoes'   ).textContent = `‚Ç¨ ${totalComissoes.toFixed(2)}`;
      document.getElementById('comissaoPercentual').textContent = `${comissaoPercent.toFixed(2)}% do total`;
      document.getElementById('totalInvestido'   ).textContent = `‚Ç¨ ${totalInvestido.toFixed(2)}`;
      document.getElementById('totalAcoes'       ).textContent = `${totalAcoes} a√ß√µes`;
      document.getElementById('saldoTotal'       ).textContent = `‚Ç¨ ${saldoTotal.toFixed(2)}`;
      document.getElementById('lucroTotal'       ).textContent = `‚Ç¨ ${lucroTotal.toFixed(2)}`;
      document.getElementById('lucroPercentual'  ).textContent = `${lucroPercentual.toFixed(2)}%`;
      document.getElementById('lastUpdate'       ).textContent = new Date().toLocaleString('pt-PT');
    }

    /* -------------------- Renderizar carteira -------------------- */
    function renderCarteira() {
      const container = document.getElementById('carteiraContainer');
      container.innerHTML = '';
      carteira.forEach(at => {
        const lucro = (at.precoAtual - at.precoCompra) * at.acoes;
        const card  = document.createElement('div');
        card.className = 'bg-gray-800 p-4 rounded-xl border border-gray-700 card-hover shadow';
        card.innerHTML = `
          <h3 class="text-xl font-bold text-blue-300">${at.nome}</h3>
          <p class="text-sm text-gray-400">${at.acoes} a√ß√µes</p>
          <p class="text-sm text-gray-400">Compra: ‚Ç¨ ${at.precoCompra}</p>
          <p class="text-sm text-gray-400">Atual: ‚Ç¨ ${at.precoAtual}</p>
          <p class="mt-2 text-sm font-semibold ${lucro >= 0 ? 'text-green-400' : 'text-red-400'}">
            Lucro: ‚Ç¨ ${lucro.toFixed(2)}
          </p>
        `;
        container.appendChild(card);
      });
    }

    /* -------------------- Renderizar transa√ß√µes -------------------- */
    function renderTransacoes() {
      const tbody = document.getElementById('transacoesTable');
      tbody.innerHTML = '';
      filteredTransacoes.forEach(tx => {
        const total = tx.preco * tx.quantidade + tx.comissao;
        const tr    = document.createElement('tr');
        tr.className = 'border-t border-gray-700 hover:bg-gray-700/30';
        tr.innerHTML = `
          <td class="px-6 py-2">${tx.tipo}</td>
          <td class="px-6 py-2">${tx.simbolo}</td>
          <td class="px-6 py-2">${tx.quantidade}</td>
          <td class="px-6 py-2">‚Ç¨ ${tx.preco}</td>
          <td class="px-6 py-2 text-red-400">‚Ç¨ ${tx.comissao}</td>
          <td class="px-6 py-2">‚Ç¨ ${total.toFixed(2)}</td>
          <td class="px-6 py-2">${tx.data}</td>
        `;
        tbody.appendChild(tr);
      });
    }

    /* -------------------- Renderizar gr√°ficos -------------------- */
    function renderGraficos() {
      const labels = carteira.map(at => at.nome);
      const valores = carteira.map(at => at.precoAtual * at.acoes);
      const cores = ['#0ea5e9','#8b5cf6','#22c55e','#f97316','#f43f5e'];

      /* --- Pie --- */
      if (pieChart) pieChart.destroy();
      pieChart = new Chart(document.getElementById('pieChart'), {
        type: 'pie',
        data: { labels, datasets: [{ data: valores, backgroundColor: cores }] },
        options: {
          responsive: true,
          plugins: { legend: { labels: { color: 'white' } } }
        }
      });

      /* --- Bar --- */
      if (barChart) barChart.destroy();
      barChart = new Chart(document.getElementById('barChart'), {
        type: 'bar',
        data: {
          labels,
          datasets: [{
            label: 'Lucro (‚Ç¨)',
            data: carteira.map(at => (at.precoAtual - at.precoCompra) * at.acoes),
            backgroundColor: cores
          }]
        },
        options: {
          responsive: true,
          plugins: { legend: { display: false } },
          scales: {
            x: { ticks: { color: 'white' } },
            y: { ticks: { color: 'white' } }
          }
        }
      });
    }

    /* -------------------- Filtros -------------------- */
    function filtrarTransacoes() {
      const tipo    = document.getElementById('filterTipo').value;
      const simbolo = document.getElementById('searchSymbol').value.toUpperCase();
      filteredTransacoes = transacoes.filter(tx =>
        (!tipo || tx.tipo === tipo) &&
        (!simbolo || tx.simbolo.includes(simbolo))
      );
      renderTransacoes();
    }
    document.getElementById('filterTipo'  ).addEventListener('change', filtrarTransacoes);
    document.getElementById('searchSymbol').addEventListener('input', filtrarTransacoes);

    /* -------------------- Atualiza√ß√£o (simulada) de pre√ßos -------------------- */
    document.getElementById('refreshBtn').addEventListener('click', () => {
      carteira.forEach(at => {
        const random = (Math.random() * 2 - 1) * 0.05;           // ¬±5 %
        at.precoAtual = parseFloat((at.precoAtual * (1 + random)).toFixed(2));
      });
      calcularMetricas();
      renderCarteira();
      renderGraficos();
    });

    /* -------------------- Inicializa√ß√£o -------------------- */
    calcularMetricas();
    renderCarteira();
    renderTransacoes();
    renderGraficos();
  </script>
</body>
</html>